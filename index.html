<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Walentynkowe Pytanie</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: linear-gradient(180deg,#fff7fb,#fff0f6);
      color: #222;
    }
    h1 { font-size: 1.1rem; line-height: 1.4; }
    #question-container { display: none; margin-top: 20px; }
    .hidden { display: none; }
    .radio-row { margin: 8px 0; }
    #other-answer input { width: 100%; padding: 8px; box-sizing: border-box; }
    input[type="submit"] { padding: 10px 16px; background:#ff6b9a; color:#fff; border:0; border-radius:6px; cursor:pointer; font-weight:700; }
    input[type="submit"]:disabled { opacity: 0.6; cursor: not-allowed; }
    /* Modal */
    .modal-backdrop { position:fixed; inset:0; background:rgba(0,0,0,0.45); display:flex; align-items:center; justify-content:center; z-index:1000; }
    .modal { background:#fff; padding:18px; border-radius:10px; width:90%; max-width:360px; text-align:center; box-shadow:0 8px 24px rgba(0,0,0,0.2); }
    .modal button { padding:8px 12px; margin:8px; border-radius:8px; border:0; cursor:pointer; font-weight:700; }
    .btn-yes { background:#ff6b9a; color:#fff; }
    .btn-no { background:#eee; color:#333; }
    .sr-only { position:absolute; left:-10000px; top:auto; width:1px; height:1px; overflow:hidden; }
  </style>
</head>
<body>
  <h1>
    Hejo SÅ‚onko. ChciaÅ‚bym, naprawdÄ™ ciÄ™ kocham caÅ‚ym serduszkiem, nic lepszego nie mogÅ‚o siÄ™ wydarzyÄ‡ jak poznanie ciebie.
    Nawet nie zdajesz sobie sprawy, jak bardzo jestem przy tobie szczÄ™Å›liwa. Wiem, Å¼e nie zawsze jest ze mnÄ… Å‚atwo i czasami ciÄ™ raniÄ™,
    nie zdajÄ…c sobie z tego sprawy, ale mimo to, nadal Olciu KOCHAM CIÄ˜ bezgranicznie i chcÄ™ byÄ‡ juÅ¼ z tobÄ… na zawsze, na dobre i na zÅ‚e,
    i mam bardzo waÅ¼ne pytanie <span id="heart" style="cursor:pointer; color:red;" role="button" aria-label="OtwÃ³rz pytanie">â¤ï¸</span>
  </h1>

  <div id="question-container" aria-hidden="true">
    <h2>Czy zostaniesz mojÄ… walentynkÄ…?</h2>

    <!-- Formularz wysyÅ‚any do Formspree (moÅ¼esz zmieniÄ‡ action) -->
    <form id="valentineForm" action="https://formspree.io/f/mqkzjbbp" method="POST" novalidate>
      <p class="sr-only">Wybierz jednÄ… z odpowiedzi</p>

      <div class="radio-row">
        <input type="radio" id="yes" name="answer" value="TakğŸ’‹â¤ï¸">
        <label for="yes">TakğŸ’‹â¤ï¸</label>
      </div>

      <div class="radio-row">
        <input type="radio" id="no" name="answer" value="NieğŸ˜­ğŸ’”">
        <label for="no">NieğŸ˜­ğŸ’”</label>
      </div>

      <div class="radio-row">
        <input type="radio" id="other" name="answer" value="Inna odpowiedÅº">
        <label for="other">Inna</label>
      </div>

      <div id="other-answer" class="hidden" aria-hidden="true">
        <label for="custom-answer">Podaj swojÄ… odpowiedÅº:</label><br>
        <input type="text" id="custom-answer" name="custom-answer" autocomplete="off" placeholder="Twoja odpowiedÅº">
      </div>

      <!-- Ukryte pole, do ktÃ³rego skopiujemy finalnÄ… odpowiedÅº przed wysÅ‚aniem -->
      <input type="hidden" id="final-answer" name="final-answer" value="">

      <br>
      <input type="submit" id="submitBtn" value="WyÅ›lij odpowiedÅº">
    </form>
  </div>

  <!-- Modal dla "Nie" -->
  <div id="modalWrap" class="hidden" aria-hidden="true">
    <div class="modal-backdrop" id="backdrop">
      <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
        <p id="modalTitle" style="font-weight:700; color:#c2185b;">Czy na pewno nie zmienisz zdania?</p>
        <div>
          <button id="confirmNo" class="btn-no">Tak, na pewno</button>
          <button id="changeMind" class="btn-yes">ZmieÅ„ zdanie</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    const heart = document.getElementById('heart');
    const questionContainer = document.getElementById('question-container');
    const otherRadio = document.getElementById('other');
    const otherAnswer = document.getElementById('other-answer');
    const customAnswer = document.getElementById('custom-answer');
    const yesNoRadios = document.querySelectorAll('input[name="answer"]');
    const form = document.getElementById('valentineForm');
    const finalAnswer = document.getElementById('final-answer');
    const submitBtn = document.getElementById('submitBtn');

    const modalWrap = document.getElementById('modalWrap');
    const confirmNo = document.getElementById('confirmNo');
    const changeMind = document.getElementById('changeMind');
    const backdrop = document.getElementById('backdrop');

    let askTimer = null;

    // PokaÅ¼ pytanie po klikniÄ™ciu serduszka
    heart.addEventListener('click', () => {
      questionContainer.style.display = 'block';
      questionContainer.setAttribute('aria-hidden', 'false');
      heart.setAttribute('aria-expanded', 'true');
      // przewiÅ„ do formularza (opcjonalnie)
      questionContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });
    });

    // PokaÅ¼/ukryj pole "Inna odpowiedÅº"
    function updateOtherField() {
      if (otherRadio.checked) {
        otherAnswer.classList.remove('hidden');
        otherAnswer.setAttribute('aria-hidden', 'false');
        customAnswer.focus();
      } else {
        otherAnswer.classList.add('hidden');
        otherAnswer.setAttribute('aria-hidden', 'true');
      }
    }

    otherRadio.addEventListener('change', updateOtherField);
    yesNoRadios.forEach(r => r.addEventListener('change', updateOtherField));

    // ObsÅ‚uga wyboru "Nie" - pokazuj modal cyklicznie dopÃ³ki nie zmieni zdania
    document.getElementById('no').addEventListener('change', () => {
      showModal();
      if (!askTimer) {
        askTimer = setInterval(() => {
          showModal();
        }, 2500); // co 2.5 sekundy przypomnienie
      }
    });

    function showModal() {
      modalWrap.classList.remove('hidden');
      modalWrap.setAttribute('aria-hidden', 'false');
    }

    function hideModal() {
      modalWrap.classList.add('hidden');
      modalWrap.setAttribute('aria-hidden', 'true');
    }

    // Potwierdzenie "Tak, na pewno" - modal zamkniÄ™ty, timer dalej pyta (zgodnie z Twoim opisem)
    confirmNo.addEventListener('click', () => {
      hideModal();
      // pokaÅ¼ krÃ³tki komunikat wizualny (opcjonalne)
      if (!document.getElementById('sad-note')) {
        const note = document.createElement('div');
        note.id = 'sad-note';
        note.style.color = '#666';
        note.style.marginTop = '12px';
        note.style.fontWeight = '600';
        note.textContent = 'Szkoda... nadal bÄ™dÄ™ pytaÄ‡.';
        questionContainer.appendChild(note);
      }
      // modal zostaje ukryty tymczasowo, ale timer moÅ¼e go ponownie pokazaÄ‡
    });

    // Zmiana zdania - pokaÅ¼ misia zamiast formularza i zatrzymaj timer
    changeMind.addEventListener('click', () => {
      hideModal();
      stopAsking();
      showTeddy();
    });

    // KlikniÄ™cie poza modal zamyka go tymczasowo
    backdrop.addEventListener('click', (e) => {
      if (e.target === backdrop) {
        hideModal();
      }
    });

    function stopAsking() {
      if (askTimer) {
        clearInterval(askTimer);
        askTimer = null;
      }
    }

    // Prosta funkcja pokazujÄ…ca misia (moÅ¼esz podmieniÄ‡ na obrazek/SVG)
    function showTeddy() {
      // UsuÅ„ formularz i pokaÅ¼ miÅ‚ego misia
      questionContainer.innerHTML = `
        <div style="text-align:center; padding:18px;">
          <svg width="220" height="220" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Pluszowy miÅ› z serduszkiem">
            <defs>
              <linearGradient id="g" x1="0" x2="1" y1="0" y2="1">
                <stop offset="0" stop-color="#ffd9c9"/>
                <stop offset="1" stop-color="#ffb3a1"/>
              </linearGradient>
            </defs>
            <circle cx="55" cy="45" r="28" fill="url(#g)"/>
            <circle cx="145" cy="45" r="28" fill="url(#g)"/>
            <circle cx="100" cy="80" r="48" fill="url(#g)"/>
            <circle cx="85" cy="75" r="6" fill="#4b2e2e"/>
            <circle cx="115" cy="75" r="6" fill="#4b2e2e"/>
            <ellipse cx="100" cy="92" rx="8" ry="6" fill="#4b2e2e"/>
            <ellipse cx="100" cy="140" rx="60" ry="48" fill="url(#g)"/>
            <g transform="translate(100,120) scale(0.9)">
              <path d="M0 -10 C -12 -30 -40 -20 -40 0 C -40 22 -10 36 0 48 C 10 36 40 22 40 0 C 40 -20 12 -30 0 -10 Z" fill="#ff4d6d"/>
            </g>
          </svg>
          <div style="margin-top:8px; color:#c2185b; font-weight:700;">Tak!!! DziÄ™kujÄ™, Å¼e zostaniesz mojÄ… WalentynkÄ…. KOCHAM CIÄ˜ ğŸ’–</div>
        </div>
      `;
    }

    // Przed wysÅ‚aniem formularza skomponuj finalnÄ… odpowiedÅº i waliduj
    form.addEventListener('submit', (e) => {
      // ZnajdÅº wybranÄ… opcjÄ™
      const chosen = document.querySelector('input[name="answer"]:checked');
      if (!chosen) {
        e.preventDefault();
        alert('ProszÄ™ wybraÄ‡ odpowiedÅº przed wysÅ‚aniem.');
        return;
      }

      let answerText = chosen.value;
      if (chosen.id === 'other') {
        const custom = customAnswer.value.trim();
        if (!custom) {
          e.preventDefault();
          alert('ProszÄ™ wpisaÄ‡ swojÄ… odpowiedÅº w polu "Inna".');
          customAnswer.focus();
          return;
        }
        answerText = `Inna: ${custom}`;
      }

      // Skopiuj do ukrytego pola, aby wysÅ‚aÄ‡ jednÄ… czytelnÄ… wartoÅ›Ä‡
      finalAnswer.value = answerText;

      // JeÅ›li chcesz, moÅ¼esz teÅ¼ zatrzymaÄ‡ cykliczne przypomnienia (bezpieczne)
      stopAsking();

      // Formularz zostanie wysÅ‚any normalnie do action
      // JeÅ›li chcesz wysyÅ‚aÄ‡ AJAX-em, zastÄ…p poniÅ¼sze zachowanie.
    });

    // Dodatkowo: jeÅ›li uÅ¼ytkownik wybierze "Tak", zatrzymaj przypominanie i pokaÅ¼ misia
    document.getElementById('yes').addEventListener('change', () => {
      stopAsking();
      showTeddy();
    });

    // JeÅ›li uÅ¼ytkownik wpisze coÅ› w pole "Inna", automatycznie zaznacz radio "Inna"
    customAnswer.addEventListener('input', () => {
      if (customAnswer.value.trim().length > 0) {
        otherRadio.checked = true;
        updateOtherField();
      }
    });
  </script>
</body>
</html>
